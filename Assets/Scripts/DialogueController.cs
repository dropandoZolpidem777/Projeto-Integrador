using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class DialogueController : MonoBehaviour
{
    // Variável para controlar se o jogador está dentro do alcance da placa
    public int jogadorPerto = 0;
    // Variavel aparecer o botão para interagir
    public GameObject botaoAparecer;
    // Tecla para interagir
    public KeyCode teclaDeInteracao = KeyCode.E;
    // sprite do npc
    public Sprite profile;
    // texto
    public string[] speechTxt;
    // nome que aparece com o dialogo
    public string actorName;
    //outro script
    private Dialogue dc;

    public GameObject DesaparecerAtaque1;
    public GameObject DesaparecerAtaque2;

    public bool iniciaLutaTowerFight = false;
    public GameObject geradorInimigo;


    private void Update()
    {

    }

    private void Start()
    {
        //chamando outro script pelo nome
        dc = GameObject.FindObjectOfType<Dialogue>();
        //se clicar E vai abrir o dialogo
        teclaDeInteracao = KeyCode.E;
    }

    public void AceionarODialogo()
    {
        if (jogadorPerto == 1)
        {

            // Exibir o diálogo
            dc.Speech(profile, speechTxt, actorName);
        }
    }

    void interacao()
    {
        // Verificar se o jogador está perto e pressionou a tecla de interação
        if (jogadorPerto == 1 && Input.GetKeyDown(teclaDeInteracao))
        {
            // Exibir o diálogo
            dc.Speech(profile, speechTxt, actorName);
        }
    }

    // Este método é chamado quando o jogador entra no collider da placa
    public void OnTriggerEnter2D(Collider2D collision)
    {
        //DesaparecerAtaque1.SetActive(false);
        DesaparecerAtaque2.SetActive(false);
        //JogadorPerto True
        jogadorPerto = 1;
        botaoAparecer.SetActive(true);
    }

    // Este método é chamado quando o jogador sai do collider da placa
    public void OnTriggerExit2D(Collider2D collision)
    {
        //DesaparecerAtaque1.SetActive(true);
        DesaparecerAtaque2.SetActive(true);
        //JogadorPerto False
        jogadorPerto = 0;
        botaoAparecer.SetActive(false);

        if(iniciaLutaTowerFight == true)
        {
            Debug.Log("Começou a luta!");
            geradorInimigo.SetActive(true);
        }

    }
}
